<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Air Plan-Chatroom</title>
    <link href="./css/main.css" rel="stylesheet" type="text/css">
    <script src="./js/chatroom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body class="chat-body">
    @@include("./layout/nav.html")
    @@include("./layout/header.html")
    <main class="chatroom-main">
        <section class="mainSection">
            <div class="sectionOver">
                <input type="hidden" name="mname" id="mname">
            </div>
        </section>
        <div class="mainBook">
            <div class="bookDashed">
                <div class="dashPage1">
                    <div class="dashPage2">
                        <div class="dashPage3">
                            <div class="dashPage4">
                                <div class="dashPage5">
                                    <img class="pageImg" src="./img/chatroom/book.png" alt="book.png">
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>分手應該體面</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>我是香菇啦2</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>我是香菇啦3</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>我是香菇啦4</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>我是香菇啦5</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>我是香菇啦6</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_1.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>我是香菇啦7</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>我是香菇啦8</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_3.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="pageContent">
                                        <div class="contentYour">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>我是香菇啦9</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>誰都不要說抱歉</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_1">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>何來虧欠</p>
                                        </div>
                                        <div class="contentMe">
                                            <p>我敢給就敢心碎</p>
                                        </div>
                                        <div class="meClearfix"></div>
                                        <div class="contentYour_2">
                                            <img src="./img/chatroom/mark_2.png" alt="">
                                            <p>鏡頭前面是從前的我們</p>
                                        </div>
                                    </div>
                                    <div class="contentSend">
                                        <form action="./js/chatroom.php" method="POST">
                                            <input class="sendText" type="text">
                                            <button><img src="./img/chatroom/send.png" alt=""></button>
                                        </form>
                                        <div class="sendClearfix"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mainClearfix"></div>
    </main>
    @@include("./layout/footer.html")

    <script>
        window.addEventListener("load", function () {
            document.querySelectorAll('.pageContent')[0].style.display = "inline-block";
            get_chat();

            let Mark = document.querySelectorAll('.sectionMark1');
            for (let i = 0; i < Mark.length; i++) {
                console.log(i);
                Mark[i].addEventListener('click', function (e) {
                    for (let j = 0; j < Mark.length; j++) {
                        Mark[j].classList.remove("MarkRed");
                        document.querySelectorAll('.pageContent')[j].style.display = "none";
                    }
                    e.currentTarget.classList.add("MarkRed");
                    document.querySelectorAll('.pageContent')[i].style.display = "inline-block";
                    console.log(e.currentTarget);
                    document.getElementsByClassName('sendText')[0].value = "";
                })
            };
        });

        function showData(str) {
            let mark = JSON.parse(str);
            console.log(mark);
            // console.log(jsonStr);
            let sectionMark1 = document.getElementsByClassName('.sectionMark1')[0];
            let sectionOver = document.getElementsByClassName('.sectionOver')[0];
            let page = document.getElementsByClassName('.pageContent')[0];
            let contentMe = document.getElementsByClassName('.contentMe')[0];
            // if(jsonStr == "mark"){
            if (mark != "") {
                for (var i in mark) {
                    $('.sectionOver').append(`<div class='sectionMark1'><img src='${mark[i].matPosUrl}'><p>${mark[i].memName}</p></div>`,
                    "<div class='pageContent'></div>");
                }
            } else {
                alert('錯誤');
            }


            // }else if (jsonStr == "chat") {
            //     if (json.memNo1) {
            //         page.append("<div class='contentMe'><p></p></div>");
            //         contentMe.getElementsByTagName_r('p')[0].innerText = json.content;
            //     }else{
            //         page.append("<div class='contentYour'><img src=''><p></p></div>");
            //         contentMe.getElementsByTagName_r('p')[0].innerText = json.content;
            //         contentMe.getElementsByTagName_r('img')[0].setAttribute("src", json.contentSrc);
            //     }
        }

        function get_chat() {
            let xhr = new XMLHttpRequest();
            // let data_info = "memNo1=" + document.getElementsByClassName('.')[0];
            let data_info = "memNo1=" + 1;
            xhr.onload = function () {
                if (xhr.status == 200) {
                    // let response = JSON.parse(response);
                    console.log(xhr.responseText);
                    showData(xhr.responseText);
                } else {
                    alert(xhr.status);
                }
            }
            xhr.open('post', './js/chatroom.php', false);
            xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');
            xhr.send(data_info);

        }
    </script>
</body>

</html>