<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>catch-letter</title>
  <link href="./css/main.css" rel="stylesheet" type="text/css">
    <style>
        * {
            box-sizing: border-box;
        }
    </style>
  <script src="./js/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r16/Stats.min.js"></script>
  <script src="./js/boid.js"></script>
  <script src="./js/butterfly.js"></script>
</head>
<body class="catchletter-body">
      <div class="nav-body">
    <div id="navHead" class="nav-navBgWrap">
        <div class="nav-navBg">
            <img src="../img/share/nav_lightBox.svg" alt="">
            <nav class="nav-navWrap">
                <!-- <div class="nav-topBlock">
                登入和設定 
            </div> -->
            <div class="nav-logoWrap">
                <a href="./home.html"><img src="./img/share/LOGO.png"></a>
            </div>
            <div class="nav-navPageWrap">
                <ul class="nav-list" id="list">
                    <li><a href="./write-letter.html">
                            <p class="nav-pageName">寫信</p> <span class="nav-circle-1 nav-now"></span>
                        </a> </li>
                    <li><a href="../catch-letter.html">
                            <p class="nav-pageName">撈信</p> <span class="nav-circle-2"></span>
                        </a> </li>
                    <li><a href="../shop.html">
                            <p class="nav-pageName">商城</p> <span class="nav-circle-3"></span>
                        </a> </li>
                    <li><a href="../cave.html">
                            <p class="nav-pageName">我的倉庫</p> <span class="nav-circle-4"></span>
                        </a> </li>
                    <li><a href="../chatroom.html">
                            <p class="nav-pageName">聊天室</p> <span class="nav-circle-5"></span>
                        </a> </li>
                    <li><a href="../classic.html">
                            <p class="nav-pageName">精華區</p> <span class="nav-circle-6"></span>
                        </a> </li>
                </ul>
                <div class="nav-road">
                    <div></div>
                </div>
            </div>
        </nav>
        <div class="nav-littleNav">
            <a href="#"><i class="fas fa-user-circle"></i></a>
            <a href="../user-setting.html"><i class="fas fa-cog"></i></a>
        </div>
        <div class="nav-pc">
            <div class="cav-paper">信紙:999</div>
            <div class="cav-coin">Air幣:777</div>
        </div>
    </div>
</div>

<div class="nav-hamPosition">
    <div class="nav-hamburgerWrap">
        <div class="hambuger" id="hamburger">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
    </div>
</div>
<<<<<<< HEAD
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    var navBar_active = function () {
        var scroll_top = $(window).scrollTop();
=======
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        var navBar_active = function () {
            var scroll_top = $(window).scrollTop();
>>>>>>> dev

        $("posision").html(scroll_top);

        if (scroll_top >= 560) {
            $("div.nav-navBgWrap").addClass("-on");
        } else {
            $("div.nav-navBgWrap").removeClass("-on");
        }
    };

    $(function () {
        $(window).scroll(function () {
            navBar_active();
        });

    });
</script>
<script>
    const hambuger = document.querySelector('.hambuger');

    hambuger.addEventListener('click', () => {
        hambuger.classList.toggle('change');
    })
</script>
<script>
    $(function () {
        // hamburger icon 的切換
        $("div.hamburger").on("click", function () {
            $(this).toggleClass("is-active");
        });

    });
    let hamburger = document.getElementById('hamburger');
    let list = document.getElementById('list');
    hamburger.addEventListener('click', function () {
        list.classList.toggle('open');
    })
</script>

  
  <div
  id="threeWorld"
  style="position: relative; overflow: hidden;"
>
  <span id="mouseNet">
    <img src="../img/catch-letter/net.png">
    <span id="missMsg"></span>
  </span>
  <div id="planeContainer"></div>
  <span id="statsBox"></span>
  <div id="planeLetter">
    <div
      id="openMotion"
      class="open-motion"
    ></div>
    <div
      id="catchLetterShow"
      class="catch-letter"
      style="display: none;"
    >
      <div class="letter-wrap">
        <div class="letter-head">
          <div class="stamp-box"></div>
          <div class="letter-tittle">
            <h3>舍，甲說，這是多麼傷心的事啊！</h3>
          </div>
        </div>
        <div class="letter-contant scroll-container">
          <div class="text">
            <p>
              籠罩著街上的煙，日頭是自東徂西，凶惡的他們忍相虐待，那時代，日月不相望的什麼新曆法，什麼是麵皮？在新月微光下的街市，看見鮮紅的血，但是他倆竟會自己走到橋上，就再開始。此刻，新年的一日，那時代，我去拿一面鑼來。在這黑暗之中，阻斷爭論，剛纔經市長一說，只有前進，在做頭老的，他不和人家分擔，不知流失多少人類所託命的田
            </p>
            <div class="letter-upload-img"></div>
            <!-- 蓋章區 -->
            <div id="stampshot">
              <!-- <div class=""></div> -->
            </div>
            <p>
              礙步的石頭，互相提攜，和狺狺的狗吠，又產生有可供消費的勢力，農民播種犁田，現在不是糴不到半斗米？
            </p>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<script src="../js/butterflyRock.js"></script>
<script>
  let threeWorld = document.getElementById('threeWorld');
  let planeLetter = document.getElementById('planeLetter');
  let openMotion = document.getElementById('openMotion');
  let catchLetterShow = document.getElementById('catchLetterShow');
  let net = document.getElementById('mouseNet');
  let missMsg = document.getElementById('missMsg');
  let planeContainer = document.getElementById('planeContainer');
  planeLetter.style = "";
  //mouseMove
  threeWorld.addEventListener('mousemove', function (e) {
    net.style.left = e.pageX + 'px';
    net.style.top = e.pageY + 'px';
  })

  threeWorld.addEventListener('mousedown', mouseDownFn);
  
  function mouseDownFn() {
    net.style.transform = 'rotate(-45deg)';
    let successNum = getRandom(10);
    successNum = 10;//.......test
    missMsg.classList = "";
    if(successNum ==  10 ){
      missMsg.innerText = "Success!";
    }else if( successNum >= 7 ){
      missMsg.innerText = "Miss!";
    }else if( successNum >= 4 ){
      missMsg.innerText = "Try Again!";
    }else{
      missMsg.innerText = "Oh No~~";
    }
    if (successNum == 10) {
      net.firstChild.src = "../img/catch-letter/catch-the-plane.gif";
      net.style.transform = 'rotate(0deg)'; //.....????
      openLetter();//開信
      document.getElementById('navHead').classList.add('-on');//將navBar推上去
      stampShot();//蓋章
      threeWorld.removeEventListener('mousedown', mouseDownFn);//解除撈信滑鼠事件
      threeWorld.removeEventListener('mouseup', mouseUpFn );//解除撈信滑鼠事件
      // changeMouseToStamp();//把滑鼠變成戳章
    } else {
      threeWorld.addEventListener('mouseup', mouseUpFn );
      function mouseUpFn(){
        net.style.transform = 'rotate(45deg)';
        missMsg.classList.add("fadeAway");
      }
    }
  }

  function openLetter() {
    planeLetter.classList.add('active');
    letterFlim();
    threeWorld.style.cursor = 'auto';
  }

  let time = 5

  function letterFlim() {
    setTimeout(() => {
      time--;
      if (time < 0) {
        setTimeout(() => {
          openMotion.style.display = "none";
          net.style.display = "none";
          catchLetterShow.style.display = "block";
          console.log(catchLetterShow);
        }, 400)
      } else {
        openMotion.style.backgroundImage = `url(../img/catch-letter/letter-fold-${time+1}.png)`
        letterFlim()
      }
      console.log(time)
    }, 400)
  }

  function getRandom(num) {
    return Math.floor(Math.random() * num) + 1;
  };
  //蓋印章
  function stampShot(){
    planeLetter.addEventListener('click',(e)=>{
      // console.log("e.offsetX: ",e.offsetX);
      // console.log("e.offsetY: ",e.offsetY);
      let stampshot = document.getElementById('stampshot');
      let stampEffectDiv = document.createElement('div');
      stampshot.style.display = "block";
      stampEffectDiv.setAttribute('id','stampEffect');
      // document.querySelector(".stampEffect")
      let LETTER_HEIGHT = planeLetter.offsetHeight;
      let LETTER_WIDTH = planeLetter.offsetWidth;
      
      stampEffectDiv.style.top = `${e.offsetY-50}px`;
      stampEffectDiv.style.left = `${e.offsetX-50}px`;
      stampEffectDiv.style.backgroundImage = `url(../img/catch-letter/user-stamp/user-stamp_${Math.floor(Math.random() * 9) + 1}.png)`;
      stampshot.appendChild(stampEffectDiv);
    })
  }
</script>
  <main id="catchLetter" v-if="viewMoreOpen === true">
    
      <div id="viewMore">
        <section class="catch-step-1">
          <div class="box-white catch-letter">
            <div class="letter-wrap">
              <div class="paper-cloud"></div>
              <div class="letter-head">
                <div class="stamp-box"></div>
                <div class="letter-tittle">
                  <h3>舍，甲說，這是多麼傷心的事啊！</h3>
                </div>
              </div>
              <div class="letter-contant scroll-container">
                <div class="text">
                  <p>籠罩著街上的煙，日頭是自東徂西，凶惡的他們忍相虐待，那時代，日月不相望的什麼新曆法，什麼是麵皮？在新月微光下的街市，看見鮮紅的血，但是他倆竟會自己走到橋上，就再開始。此刻，新年的一日，那時代，我去拿一面鑼來。在這黑暗之中，阻斷爭論，剛纔經市長一說，只有前進，在做頭老的，他不和人家分擔，不知流失多少人類所託命的田
                  </p> 
                  <div class="letter-upload-img"></div>
                  <p>
                    礙步的石頭，互相提攜，和狺狺的狗吠，又產生有可供消費的勢力，農民播種犁田，現在不是糴不到半斗米？
                  </p> 
                </div>
              </div>
              
            </div>
          </div>
          <div class="dot-box-yellow comment-wrap">
            <span class="share-clip clip-left"></span>
            <div class="box-white top-left-bg">
                <div class="box-white top-left-bg">
  
                  <div class="dot-box-white comment-outbox scroll-container">
                    <template v-for="(item, index) in 5">
                      <div class="box-white comment">
                        <div class="comment-contant">
                          <h3 class="user-name">XXXXXXX</h3>
                          <p class="user-text">真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！真是太有趣了！</p>
                        </div>
                        <!-- btn -->
                        <div class="comment-btn">
                          <!-- 檢舉 -->
                          <div class="circle" id="threed">
                            <button class="circle button"></button>
                          </div>
                          
                        </div>
                      </div>
                    </template>
                  </div>
  
                </div>
            </div>
          </div>
        </section>
        <section class="catch-step-2">
  
        </section>
        <section class="catch-step-3" id="catchStep3">
            
        </section>
        <section class="catch-step-4" id="catchStep4">
            
        </section>
  
        <div class="test-area"></div>
      </div>
      
  </main>
    
    
  <script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js'></script>
  <script>
    

    new Vue({
      el:'#catchLetter',
      data:{
        // threeOpen: true,
        viewMoreOpen:false,
      },
    });
  </script>
</body>
</html>